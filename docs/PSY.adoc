
== PSY: 空気状態値の算出

=== 目的

乾球温度[℃]と「湿球温度[℃]、露点温度[℃]、相対湿度[%]、絶対湿度[kg/kg]、水蒸気分圧[mmHg]、エンタルピー[kcal/kg]」のいずれかを与えて、乾球温度[℃]、湿球温度[℃]、露点温度[℃]、相対湿度[%]、絶対湿度[kg/kg]、水蒸気分圧[mmHg]、エンタルピー[kcal/kg]を算出する。

=== 入出力

.入力
[options="header" cols="1,4,2"]
|=================================
|変数名|説明|単位
|stem:[T_{db}]| 乾球温度（必須） |℃ 
|stem:[T_{wb}]| 湿球温度（任意） |℃ 
|stem:[T_{dew}]| 露点温度（任意） |℃ 
|stem:[R]| 相対湿度（任意） |℃ 
|stem:[X]| 絶対湿度（任意） |kg/kg
|stem:[P]| 水蒸気分圧（任意） |mmHg
|stem:[H]| エンタルピー（任意） |kcal/kJ
|=================================

.出力
[options="header" cols="1,4,2"]
|=================================
|変数名|説明|単位
|stem:[T_{db}]| 乾球温度 |℃ 
|stem:[T_{wb}]| 湿球温度 |℃ 
|stem:[T_{dew}]| 露点温度 |℃ 
|stem:[R]| 相対湿度 |℃ 
|stem:[X]| 絶対湿度 |kg/kg
|stem:[P]| 水蒸気分圧 |mmHg
|stem:[H]| エンタルピー |kcal/kJ
|=================================

=== 使用する関数

* PS
* FG

=== 計算ロジック

==== サブ関数の定義
計算に使用するサブ関数を次式で定義する。


* 水蒸気分圧 stem:[P][mmHg] から 絶対湿度 stem:[X][kg/kg] を算出する関数AH
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X = \rm{AH(P)} = \frac{0.622 P}{760-P}
++++++++++++++++++++++++++++++++++++++++++++
====


* 水蒸気分圧 stem:[P_{atm}][atm] から 絶対湿度 stem:[X] [kg/kg] を算出する関数A
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X = \rm{A(P_{atm})} = \frac{0.622 P_{atm}}{1-P_{atm}}
++++++++++++++++++++++++++++++++++++++++++++
====

* 絶対湿度 stem:[X][kg/kg] から 水蒸気分圧 stem:[P][mmHg] を算出する関数CH
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P = \rm{CH(X)} = \frac{760 X}{0.622 + X}
++++++++++++++++++++++++++++++++++++++++++++
====

* 絶対湿度 stem:[X][kg/kg] から 水蒸気分圧 stem:[P_{atm}][atm] を算出する関数C
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P_{atm} = \rm{C(X)} = \frac{X}{0.622 + X}
++++++++++++++++++++++++++++++++++++++++++++
====

* 湿球温度stem:[T_{wb}][℃]のときの飽和絶対湿度stem:[X_{s}][kg/kg]、乾球温度stem:[T_{db}][℃]、湿球温度stem:[T_{wb}][℃]から、絶対湿度 stem:[X][kg/kg] を算出する関数B
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X = \rm{B(X_{wb}, T_{db}, T_{wb})} = \frac{ (597.3 - 0.559T_{wb}) X_{s} - 0.240 (T_{db}-T_{wb}) }{ 597.3 + 0.441 T_{db} - T_{wb} }
++++++++++++++++++++++++++++++++++++++++++++
====

* 絶対湿度 stem:[X][kg/kg] から露点温度stem:[T_{dew}]を算出する関数TD
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{TD(X)} = 90.93743 + log(X)(16.98006 + \\
log(X)(-0.7905916 + log(X)(-0.2411693-0.01389958log(X)))) + \\
0.8045291 | log(X)+5.580150 |
++++++++++++++++++++++++++++++++++++++++++++
====

* 乾球温度[℃]と絶対湿度[kg/kg]からエンタルピー[kcal/kg]を算出する関数HF
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H = \rm{HF(T_{db}, X)} = 0.240 T_{db} + (597.3+0.441T_{db})X
++++++++++++++++++++++++++++++++++++++++++++
====

* 乾球温度[℃]とエンタルピー[kcal/kg]から絶対湿度[kg/kg]を算出する関数XF
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X = \rm{XF(H, T_{db})} = \frac{H-0.240T_{db}}{597.3+0.441T_{db}}
++++++++++++++++++++++++++++++++++++++++++++
====

==== 湿球温度が入力された場合 

乾球温度 stem:[T_{db}] と湿球温度 stem:[T_{wb}] が入力された場合は、次式で出力を算出する。

====
湿球温度 stem:[T_{wb}] のときの飽和水蒸気分圧 stem:[P_{s}][atm]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P_{s} = \rm{PS(T_{wb})}
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] のときの飽和絶対湿度 stem:[X_{s}] [kg/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X_{s} = \rm{A(P_{s})}
++++++++++++++++++++++++++++++++++++++++++++
絶対湿度 stem:[X] [kg/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X  = \rm{B(X_{s},T_{db},T_{wb})} 
++++++++++++++++++++++++++++++++++++++++++++
露点温度 stem:[T_{dew}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{TD(X)}
++++++++++++++++++++++++++++++++++++++++++++
相対湿度 stem:[R] [%]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
R  = \frac{\rm{C(X)}}{\rm{PS(T_{db})}} \times 100
++++++++++++++++++++++++++++++++++++++++++++
水蒸気分圧 stem:[P] [mmHg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P  = \rm{CH(X)}
++++++++++++++++++++++++++++++++++++++++++++
エンタルピー stem:[H] [kcal/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H  = \rm{HF(T_{db}, X)} 
++++++++++++++++++++++++++++++++++++++++++++
====

==== 露点温度が入力された場合

乾球温度 stem:[T_{db}] と露点温度 stem:[T_{dew}] が入力された場合は、次式で出力を算出する。

====
露点温度 stem:[T_{dew}] のときの飽和水蒸気分圧 stem:[P_{atm}] [atm]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P_{atm} = \rm{PS(T_{dew})} 
++++++++++++++++++++++++++++++++++++++++++++
水蒸気分圧 stem:[P] [mmHg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P = P_{atm} \times 760
++++++++++++++++++++++++++++++++++++++++++++
絶対湿度 stem:[X] [kg/kg] 
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X  = \rm{A(P_{atm})}
++++++++++++++++++++++++++++++++++++++++++++
エンタルピー stem:[H] [kcal/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H  = \rm{HF(T_{db},X)}
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \rm{FG(H,X)}
++++++++++++++++++++++++++++++++++++++++++++
相対湿度 stem:[R] [%]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
R  = \frac{\rm{P_{atm}}}{\rm{PS(T_{db})}} \times 100
++++++++++++++++++++++++++++++++++++++++++++
====

==== 相対湿度が入力された場合

乾球温度 stem:[T_{db}] と相対湿度 stem:[R] が入力された場合は、次式で出力を算出する。

====
水蒸気分圧 stem:[P_{atm}] [atm]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P_{atm} = \frac{\rm{PS(T_{db})} R}{100}
++++++++++++++++++++++++++++++++++++++++++++
水蒸気分圧 stem:[P] [mmHg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P  = 760 P_{atm}
++++++++++++++++++++++++++++++++++++++++++++
絶対湿度 stem:[X] [kg/kg] 
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X  = \rm{A(P_{atm})}
++++++++++++++++++++++++++++++++++++++++++++
エンタルピー stem:[H] [kcal/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H  = \rm{HF(T_{db},X)}
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \rm{FG(H,X)}
++++++++++++++++++++++++++++++++++++++++++++
露点温度 stem:[T_{dew}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{TD(X)}
++++++++++++++++++++++++++++++++++++++++++++
====

==== 絶対湿度が入力された場合

乾球温度 stem:[T_{db}] と絶対湿度 stem:[X] が入力された場合は、次式で出力を算出する。

====
エンタルピー stem:[H] [kcal/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H  = \rm{HF(T_{db},X)} 
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \rm{FG(H,X)}
++++++++++++++++++++++++++++++++++++++++++++
露点温度  stem:[T_{dew}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{TD(X)} 
++++++++++++++++++++++++++++++++++++++++++++
水蒸気分圧 stem:[P] [mmHg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P  = \rm{CH(X)}
++++++++++++++++++++++++++++++++++++++++++++
相対湿度 stem:[R] [%]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
R  = \frac{\rm{C(X)}}{\rm{PS(T_{db})}} \times 100
++++++++++++++++++++++++++++++++++++++++++++
====

==== 水蒸気分圧[mmHg]が入力された場合

乾球温度 stem:[T_{db}] と水蒸気分圧 stem:[P] が入力された場合は、次式で出力を算出する。

====
絶対湿度 stem:[X] [kg/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X = \rm{AH(P)} 
++++++++++++++++++++++++++++++++++++++++++++
エンタルピー stem:[H] [kcal/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
H  = \rm{HF(T_{db},X)}
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \rm{FG(H,X)}
++++++++++++++++++++++++++++++++++++++++++++
露点温度 stem:[T_{dew}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{D(X)}
++++++++++++++++++++++++++++++++++++++++++++
相対湿度 stem:[R] [%]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
R  = \frac{P}{(\rm{PS(T_{db})} 760)} \times 100
++++++++++++++++++++++++++++++++++++++++++++
====

==== エンタルピーが入力された場合

乾球温度 stem:[T_{db}] とエンタルピー stem:[H] が入力された場合は、次式で出力を算出する。

====
絶対湿度 stem:[X] [kg/kg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X  = \rm{XF(H,T_{db})}
++++++++++++++++++++++++++++++++++++++++++++
湿球温度 stem:[T_{wb}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \rm{FG(H,X)}
++++++++++++++++++++++++++++++++++++++++++++
露点温度 stem:[T_{dew}] [℃]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{dew} = \rm{TD(X)}
++++++++++++++++++++++++++++++++++++++++++++
相対湿度 stem:[R] [%]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
R  = \frac{\rm{C(X)}}{\rm{PS(T_{db})}} \times 100
++++++++++++++++++++++++++++++++++++++++++++
水蒸気分圧 stem:[P] [mmHg]
[stem]
++++++++++++++++++++++++++++++++++++++++++++
P  = \rm{CH(X)}
++++++++++++++++++++++++++++++++++++++++++++
====

