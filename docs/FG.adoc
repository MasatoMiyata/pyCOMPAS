
== FG: 湿球温度の算出

=== 目的

エンタルピー[kcal/kg]、絶対湿度[kg/kg]を与えて、湿球温度[℃]を算出する（松尾の近似式）。

=== 入出力

.入力
[options="header" cols="1,4,2"]
|=================================
|変数名|説明|単位
|stem:[H]| エンタルピー | kcal/kg
|stem:[X]| 絶対湿度 | kg/kg
|=================================

.出力
[options="header" cols="1,4,2"]
|=================================
|変数名|説明|単位
|stem:[T_{wb}] | 湿球温度 | ℃ |
|=================================

=== 使用する関数

* PS

=== 計算ロジック

松尾の近似式より、湿球温度 stem:[T_{wb}] [℃]を算出する。

====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = \frac{ -5.638340 + H (2.677933 + H (-6.721679 \cdot 10^{-2} + 7.856989 \cdot 10^{-4} H )) } 
        { 1.0 + (2.860526 + H (-1.82433 \cdot 10^{-1} + H (5.77939 \cdot 10^{-3} - 7.1060 \cdot 10^{-5} H))) X }
++++++++++++++++++++++++++++++++++++++++++++
====

精度を高めるために次の収束計算を行う。 + 
まず、次式により、stem:[T_{wb,new}] を算出する。
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
X_{S} = 0.622  \frac{ \rm{PS(T_{db})} }{ 1 - \rm{PS(T_{db})} } \\ 
T_{wb,new} = \frac{ H - 597.3 X_{S} }{ 0.240 - 0.559 X_{S} + X}
++++++++++++++++++++++++++++++++++++++++++++
====

ここで、stem:[ | T_{wb,new} - T_{wb} | < 0.001 ] を満たすまで、
stem:[T_{wb}]の値に更新し、再度 stem:[T_{wb,new}]を算出する。
====
[stem]
++++++++++++++++++++++++++++++++++++++++++++
T_{wb} = 0.6 T_{wb} + 0.4 T_{wb,new}
++++++++++++++++++++++++++++++++++++++++++++
====

繰り返し回数は最大10回までとする。

=== 計算例

* 計算例① +
stem:[H] = 52.335、stem:[X] = 0.0105 のとき、stem:[T_{wb}] = 18.6

* 計算例② +
stem:[H] = 20.0、stem:[X] = 0.002 のとき、stem:[T_{wb}] = 5.9

=== 補足説明

* プログラムとしては松尾の近似式で終えるべきであるが、応急的にその後に収束ループを付加して精度を上げている。

=== ソースコード

[source,python]
----
include::../FG.py[]
----